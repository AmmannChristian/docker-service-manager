# OIDC Configuration (ZITADEL) - Production Grade
# Application type: service = backend API, no web login redirects
quarkus.oidc.application-type=service

quarkus.oidc.auth-server-url=${OIDC_AUTH_SERVER_URL}
quarkus.oidc.client-id=${OIDC_CLIENT_ID}

# Discovery endpoint cache (reduces calls to /.well-known/openid-configuration)
quarkus.oidc.discovery-enabled=true
quarkus.oidc.jwks-path=/oauth/v2/keys

# Authentication Method: private_key_jwt (RFC 7523)
quarkus.oidc.credentials.jwt.key-file=${OIDC_JWT_KEY_FILE}
quarkus.oidc.credentials.jwt.token-key-id=${OIDC_JWT_KEY_ID}
quarkus.oidc.credentials.jwt.lifespan=${OIDC_JWT_LIFESPAN:300}
quarkus.oidc.credentials.jwt.audience=${OIDC_JWT_AUDIENCE:${quarkus.oidc.auth-server-url}/oauth/v2/token}

# Token Validation Settings
quarkus.oidc.token.audience=${quarkus.oidc.client-id}
quarkus.oidc.token.verify-access-token-with-user-info=false

# Support both JWT (local verification) and opaque tokens (introspection)
quarkus.oidc.token.allow-opaque-token-introspection=true
quarkus.oidc.token.allow-jwt-introspection=false

# ZITADEL introspection endpoint
quarkus.oidc.introspection-path=/oauth/v2/introspect

# Roles Extraction (ZITADEL specific claim path)
quarkus.oidc.roles.source=accesstoken
quarkus.oidc.roles.role-claim-path=urn:zitadel:iam:org:project:roles
